{"remainingRequest":"/data/ssd/niklas/workspace/vue-keycloak-auth/node_modules/babel-loader/lib/index.js!/data/ssd/niklas/workspace/vue-keycloak-auth/node_modules/eslint-loader/index.js??ref--13-0!/data/ssd/niklas/workspace/vue-keycloak-auth/src/main.js","dependencies":[{"path":"/data/ssd/niklas/workspace/vue-keycloak-auth/src/main.js","mtime":1633596541916},{"path":"/data/ssd/niklas/workspace/vue-keycloak-auth/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/data/ssd/niklas/workspace/vue-keycloak-auth/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/data/ssd/niklas/workspace/vue-keycloak-auth/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICIvZGF0YS9zc2QvbmlrbGFzL3dvcmtzcGFjZS92dWUta2V5Y2xvYWstYXV0aC9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lml0ZXJhdG9yLmpzIjsKaW1wb3J0ICIvZGF0YS9zc2QvbmlrbGFzL3dvcmtzcGFjZS92dWUta2V5Y2xvYWstYXV0aC9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLnByb21pc2UuanMiOwppbXBvcnQgIi9kYXRhL3NzZC9uaWtsYXMvd29ya3NwYWNlL3Z1ZS1rZXljbG9hay1hdXRoL25vZGVfbW9kdWxlcy9jb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmFzc2lnbi5qcyI7CmltcG9ydCAiL2RhdGEvc3NkL25pa2xhcy93b3Jrc3BhY2UvdnVlLWtleWNsb2FrLWF1dGgvbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lcy5wcm9taXNlLmZpbmFsbHkuanMiOwppbXBvcnQgVnVlIGZyb20gJ3Z1ZSc7CmltcG9ydCBBcHAgZnJvbSAnLi9BcHAudnVlJzsKaW1wb3J0IHZ1ZXRpZnkgZnJvbSAnLi9wbHVnaW5zL3Z1ZXRpZnknOwppbXBvcnQgVnVlUm91dGVyIGZyb20gJ3Z1ZS1yb3V0ZXInOwppbXBvcnQgeyByb3V0ZXMgfSBmcm9tICIuL3JvdXRlcyI7CmltcG9ydCBLZXljbG9hayBmcm9tICJrZXljbG9hay1qcyI7CmltcG9ydCBWdWVKd3REZWNvZGUgZnJvbSAidnVlLWp3dC1kZWNvZGUiOwppbXBvcnQgeyBzdG9yZSB9IGZyb20gIi4vc3RvcmUvc3RvcmUiOwp2YXIgcm91dGVyID0gbmV3IFZ1ZVJvdXRlcih7CiAgcm91dGVzOiByb3V0ZXMKfSk7ClZ1ZS5jb25maWcucHJvZHVjdGlvblRpcCA9IGZhbHNlOwpWdWUudXNlKFZ1ZVJvdXRlcik7IC8vS2V5Y2xvYWsgT3B0aW9ucwoKdmFyIGluaXRPcHRpb25zID0gewogIHVybDogJ2h0dHA6Ly8xMjcuMC4wLjE6ODA4MC9hdXRoJywKICByZWFsbTogJ3Z1ZS1rZXljbG9haycsCiAgY2xpZW50SWQ6ICdhcHAtdnVlJywKICBvbkxvYWQ6ICdsb2dpbi1yZXF1aXJlZCcKfTsKdmFyIGtleWNsb2FrID0gS2V5Y2xvYWsoaW5pdE9wdGlvbnMpOwpWdWUucHJvdG90eXBlLmtleWNsb2FrLmluaXQoewogIG9uTG9hZDogaW5pdE9wdGlvbnMub25Mb2FkCn0pLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHsKICBpZiAoIWF1dGgpIHsKICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKICB9IGVsc2UgewogICAgY29uc29sZS5sb2coIkF1dGhlbnRpY2F0ZWQiKTsKICAgIG5ldyBWdWUoewogICAgICB2dWV0aWZ5OiB2dWV0aWZ5LAogICAgICByb3V0ZXI6IHJvdXRlciwKICAgICAgc3RvcmU6IHN0b3JlLAogICAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihoKSB7CiAgICAgICAgcmV0dXJuIGgoQXBwLCB7CiAgICAgICAgICBwcm9wczogewogICAgICAgICAgICBrZXljbG9hazoga2V5Y2xvYWsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSkuJG1vdW50KCcjYXBwJyk7CiAgfQoKICBjb25zb2xlLmxvZyhrZXljbG9hay50b2tlbik7CiAgdmFyIGRlY29kZWRfdG9rZW4gPSBWdWVKd3REZWNvZGUuZGVjb2RlKGtleWNsb2FrLnRva2VuKTsKICBjb25zb2xlLmxvZyhkZWNvZGVkX3Rva2VuKTsKICB2YXIgcm9sZXMgPSBkZWNvZGVkX3Rva2VuLnJlYWxtX2FjY2Vzcy5yb2xlczsKICB2YXIgZmlyc3RuYW1lID0gZGVjb2RlZF90b2tlbi5naXZlbl9uYW1lOwogIHZhciBsYXN0bmFtZSA9IGRlY29kZWRfdG9rZW4uZmFtaWx5X25hbWU7CiAgc3RvcmUuY29tbWl0KCJzdG9yZV9maXJzdG5hbWUiLCBmaXJzdG5hbWUpOwogIHN0b3JlLmNvbW1pdCgic3RvcmVfbGFzdG5hbWUiLCBsYXN0bmFtZSk7CiAgc3RvcmUuY29tbWl0KCJzdG9yZV9yb2xlcyIsIHJvbGVzKTsKICBjb25zb2xlLmxvZyhyb2xlcyk7CiAgY29uc29sZS5sb2coZmlyc3RuYW1lKTsKICBjb25zb2xlLmxvZyhsYXN0bmFtZSk7IC8vVG9rZW4gUmVmcmVzaAoKICBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICBrZXljbG9hay51cGRhdGVUb2tlbig3MCkudGhlbihmdW5jdGlvbiAocmVmcmVzaGVkKSB7CiAgICAgIGlmIChyZWZyZXNoZWQpIHsKICAgICAgICBjb25zb2xlLmxvZygnVG9rZW4gcmVmcmVzaGVkJyArIHJlZnJlc2hlZCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS53YXJuKCdUb2tlbiBub3QgcmVmcmVzaGVkLCB2YWxpZCBmb3IgJyArIE1hdGgucm91bmQoa2V5Y2xvYWsudG9rZW5QYXJzZWQuZXhwICsga2V5Y2xvYWsudGltZVNrZXcgLSBuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApICsgJyBzZWNvbmRzJyk7CiAgICAgIH0KICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHJlZnJlc2ggdG9rZW4nKTsKICAgIH0pOwogIH0sIDYwMDApOwp9KS5jYXRjaChmdW5jdGlvbiAoKSB7CiAgY29uc29sZS5lcnJvcigiQXV0aGVudGljYXRlZCBGYWlsZWQiKTsKfSk7"},{"version":3,"sources":["/data/ssd/niklas/workspace/vue-keycloak-auth/src/main.js"],"names":["Vue","App","vuetify","VueRouter","routes","Keycloak","VueJwtDecode","store","router","config","productionTip","use","initOptions","url","realm","clientId","onLoad","keycloak","prototype","init","then","auth","window","location","reload","console","log","render","h","props","$mount","token","decoded_token","decode","roles","realm_access","firstname","given_name","lastname","family_name","commit","setInterval","updateToken","refreshed","warn","Math","round","tokenParsed","exp","timeSkew","Date","getTime","catch","error"],"mappings":"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","sourcesContent":["import Vue from 'vue'\nimport App from './App.vue'\nimport vuetify from './plugins/vuetify'\nimport VueRouter from 'vue-router';\nimport {routes} from \"./routes\";\nimport Keycloak from \"keycloak-js\";\nimport VueJwtDecode from \"vue-jwt-decode\";\nimport {store} from \"./store/store\";\n\n\nconst router = new VueRouter({\n  routes: routes\n})\n\nVue.config.productionTip = false\nVue.use(VueRouter)\n\n\n//Keycloak Options\nlet initOptions = {\n  url: 'http://127.0.0.1:8080/auth',\n  realm: 'vue-keycloak',\n  clientId: 'app-vue',\n  onLoad: 'login-required'\n}\n\nlet keycloak = Keycloak(initOptions);\nVue.prototype.\n\nkeycloak.init({ onLoad: initOptions.onLoad }).then((auth) => {\n  if (!auth) {\n    window.location.reload();\n  } else {\n    console.log(\"Authenticated\");\n\n    new Vue({\n      vuetify, router, store,\n      render: h => h(App, { props: { keycloak: keycloak } })\n    }).$mount('#app')\n  }\n\n  console.log(keycloak.token);\n  const decoded_token = VueJwtDecode.decode(keycloak.token);\n  console.log(decoded_token);\n  const roles = decoded_token.realm_access.roles;\n  const firstname = decoded_token.given_name;\n  const lastname = decoded_token.family_name;\n  store.commit(\"store_firstname\", firstname);\n  store.commit(\"store_lastname\", lastname);\n  store.commit(\"store_roles\", roles);\n  console.log(roles);\n  console.log(firstname);\n  console.log(lastname);\n\n//Token Refresh\n  setInterval(() => {\n    keycloak.updateToken(70).then((refreshed) => {\n      if (refreshed) {\n        console.log('Token refreshed' + refreshed);\n      } else {\n        console.warn('Token not refreshed, valid for '\n            + Math.round(keycloak.tokenParsed.exp + keycloak.timeSkew - new Date().getTime() / 1000) + ' seconds');\n      }\n    }).catch(() => {\n      console.error('Failed to refresh token');\n    });\n  }, 6000)\n\n}).catch(() => {\n  console.error(\"Authenticated Failed\");\n});"]}]}