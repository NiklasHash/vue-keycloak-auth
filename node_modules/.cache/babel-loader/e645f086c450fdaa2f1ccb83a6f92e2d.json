{"remainingRequest":"/data/ssd/niklas/workspace/vue-keycloak-auth/node_modules/babel-loader/lib/index.js!/data/ssd/niklas/workspace/vue-keycloak-auth/node_modules/eslint-loader/index.js??ref--13-0!/data/ssd/niklas/workspace/vue-keycloak-auth/src/main.js","dependencies":[{"path":"/data/ssd/niklas/workspace/vue-keycloak-auth/src/main.js","mtime":1633594044776},{"path":"/data/ssd/niklas/workspace/vue-keycloak-auth/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/data/ssd/niklas/workspace/vue-keycloak-auth/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/data/ssd/niklas/workspace/vue-keycloak-auth/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICIvZGF0YS9zc2QvbmlrbGFzL3dvcmtzcGFjZS92dWUta2V5Y2xvYWstYXV0aC9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lml0ZXJhdG9yLmpzIjsKaW1wb3J0ICIvZGF0YS9zc2QvbmlrbGFzL3dvcmtzcGFjZS92dWUta2V5Y2xvYWstYXV0aC9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLnByb21pc2UuanMiOwppbXBvcnQgIi9kYXRhL3NzZC9uaWtsYXMvd29ya3NwYWNlL3Z1ZS1rZXljbG9hay1hdXRoL25vZGVfbW9kdWxlcy9jb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmFzc2lnbi5qcyI7CmltcG9ydCAiL2RhdGEvc3NkL25pa2xhcy93b3Jrc3BhY2UvdnVlLWtleWNsb2FrLWF1dGgvbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lcy5wcm9taXNlLmZpbmFsbHkuanMiOwppbXBvcnQgVnVlIGZyb20gJ3Z1ZSc7CmltcG9ydCBBcHAgZnJvbSAnLi9BcHAudnVlJzsKaW1wb3J0IHZ1ZXRpZnkgZnJvbSAnLi9wbHVnaW5zL3Z1ZXRpZnknOwppbXBvcnQgVnVlUm91dGVyIGZyb20gJ3Z1ZS1yb3V0ZXInOwppbXBvcnQgeyByb3V0ZXMgfSBmcm9tICIuL3JvdXRlcyI7CmltcG9ydCBLZXljbG9hayBmcm9tICJrZXljbG9hay1qcyI7CmltcG9ydCBWdWVKd3REZWNvZGUgZnJvbSAidnVlLWp3dC1kZWNvZGUiOwp2YXIgcm91dGVyID0gbmV3IFZ1ZVJvdXRlcih7CiAgcm91dGVzOiByb3V0ZXMKfSk7ClZ1ZS5jb25maWcucHJvZHVjdGlvblRpcCA9IGZhbHNlOwpWdWUudXNlKFZ1ZVJvdXRlcik7IC8vS2V5Y2xvYWsgT3B0aW9ucwoKdmFyIGluaXRPcHRpb25zID0gewogIHVybDogJ2h0dHA6Ly8xMjcuMC4wLjE6ODA4MC9hdXRoJywKICByZWFsbTogJ3Z1ZS1rZXljbG9haycsCiAgY2xpZW50SWQ6ICdhcHAtdnVlJywKICBvbkxvYWQ6ICdsb2dpbi1yZXF1aXJlZCcKfTsKdmFyIGtleWNsb2FrID0gS2V5Y2xvYWsoaW5pdE9wdGlvbnMpOwprZXljbG9hay5pbml0KHsKICBvbkxvYWQ6IGluaXRPcHRpb25zLm9uTG9hZAp9KS50aGVuKGZ1bmN0aW9uIChhdXRoKSB7CiAgaWYgKCFhdXRoKSB7CiAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgfSBlbHNlIHsKICAgIGNvbnNvbGUubG9nKCJBdXRoZW50aWNhdGVkIik7CiAgICBuZXcgVnVlKHsKICAgICAgdnVldGlmeTogdnVldGlmeSwKICAgICAgcm91dGVyOiByb3V0ZXIsCiAgICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKGgpIHsKICAgICAgICByZXR1cm4gaChBcHAsIHsKICAgICAgICAgIHByb3BzOiB7CiAgICAgICAgICAgIGtleWNsb2FrOiBrZXljbG9hawogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9KS4kbW91bnQoJyNhcHAnKTsKICB9CgogIGNvbnNvbGUubG9nKGtleWNsb2FrLnRva2VuKTsKICB2YXIgZGVjb2RlZF90b2tlbiA9IFZ1ZUp3dERlY29kZS5kZWNvZGUoa2V5Y2xvYWsudG9rZW4pOwogIGNvbnNvbGUubG9nKGRlY29kZWRfdG9rZW4pOyAvL1Rva2VuIFJlZnJlc2gKCiAgc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAga2V5Y2xvYWsudXBkYXRlVG9rZW4oNzApLnRoZW4oZnVuY3Rpb24gKHJlZnJlc2hlZCkgewogICAgICBpZiAocmVmcmVzaGVkKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1Rva2VuIHJlZnJlc2hlZCcgKyByZWZyZXNoZWQpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUud2FybignVG9rZW4gbm90IHJlZnJlc2hlZCwgdmFsaWQgZm9yICcgKyBNYXRoLnJvdW5kKGtleWNsb2FrLnRva2VuUGFyc2VkLmV4cCArIGtleWNsb2FrLnRpbWVTa2V3IC0gbmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKSArICcgc2Vjb25kcycpOwogICAgICB9CiAgICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byByZWZyZXNoIHRva2VuJyk7CiAgICB9KTsKICB9LCA2MDAwKTsKfSkuY2F0Y2goZnVuY3Rpb24gKCkgewogIGNvbnNvbGUuZXJyb3IoIkF1dGhlbnRpY2F0ZWQgRmFpbGVkIik7Cn0pOw=="},{"version":3,"sources":["/data/ssd/niklas/workspace/vue-keycloak-auth/src/main.js"],"names":["Vue","App","vuetify","VueRouter","routes","Keycloak","VueJwtDecode","router","config","productionTip","use","initOptions","url","realm","clientId","onLoad","keycloak","init","then","auth","window","location","reload","console","log","render","h","props","$mount","token","decoded_token","decode","setInterval","updateToken","refreshed","warn","Math","round","tokenParsed","exp","timeSkew","Date","getTime","catch","error"],"mappings":";;;;AAAA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,GAAP,MAAgB,WAAhB;AACA,OAAOC,OAAP,MAAoB,mBAApB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAAQC,MAAR,QAAqB,UAArB;AACA,OAAOC,QAAP,MAAqB,aAArB;AACA,OAAOC,YAAP,MAAyB,gBAAzB;AAGA,IAAMC,MAAM,GAAG,IAAIJ,SAAJ,CAAc;AAC3BC,EAAAA,MAAM,EAAEA;AADmB,CAAd,CAAf;AAIAJ,GAAG,CAACQ,MAAJ,CAAWC,aAAX,GAA2B,KAA3B;AACAT,GAAG,CAACU,GAAJ,CAAQP,SAAR,E,CAGA;;AACA,IAAIQ,WAAW,GAAG;AAChBC,EAAAA,GAAG,EAAE,4BADW;AAEhBC,EAAAA,KAAK,EAAE,cAFS;AAGhBC,EAAAA,QAAQ,EAAE,SAHM;AAIhBC,EAAAA,MAAM,EAAE;AAJQ,CAAlB;AAOA,IAAIC,QAAQ,GAAGX,QAAQ,CAACM,WAAD,CAAvB;AAEAK,QAAQ,CAACC,IAAT,CAAc;AAAEF,EAAAA,MAAM,EAAEJ,WAAW,CAACI;AAAtB,CAAd,EAA8CG,IAA9C,CAAmD,UAACC,IAAD,EAAU;AAC3D,MAAI,CAACA,IAAL,EAAW;AACTC,IAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB;AACD,GAFD,MAEO;AACLC,IAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;AAEA,QAAIxB,GAAJ,CAAQ;AACNE,MAAAA,OAAO,EAAPA,OADM;AACGK,MAAAA,MAAM,EAANA,MADH;AAENkB,MAAAA,MAAM,EAAE,gBAAAC,CAAC;AAAA,eAAIA,CAAC,CAACzB,GAAD,EAAM;AAAE0B,UAAAA,KAAK,EAAE;AAAEX,YAAAA,QAAQ,EAAEA;AAAZ;AAAT,SAAN,CAAL;AAAA;AAFH,KAAR,EAGGY,MAHH,CAGU,MAHV;AAID;;AAEDL,EAAAA,OAAO,CAACC,GAAR,CAAYR,QAAQ,CAACa,KAArB;AACA,MAAMC,aAAa,GAAGxB,YAAY,CAACyB,MAAb,CAAoBf,QAAQ,CAACa,KAA7B,CAAtB;AACAN,EAAAA,OAAO,CAACC,GAAR,CAAYM,aAAZ,EAd2D,CAgB7D;;AACEE,EAAAA,WAAW,CAAC,YAAM;AAChBhB,IAAAA,QAAQ,CAACiB,WAAT,CAAqB,EAArB,EAAyBf,IAAzB,CAA8B,UAACgB,SAAD,EAAe;AAC3C,UAAIA,SAAJ,EAAe;AACbX,QAAAA,OAAO,CAACC,GAAR,CAAY,oBAAoBU,SAAhC;AACD,OAFD,MAEO;AACLX,QAAAA,OAAO,CAACY,IAAR,CAAa,oCACPC,IAAI,CAACC,KAAL,CAAWrB,QAAQ,CAACsB,WAAT,CAAqBC,GAArB,GAA2BvB,QAAQ,CAACwB,QAApC,GAA+C,IAAIC,IAAJ,GAAWC,OAAX,KAAuB,IAAjF,CADO,GACkF,UAD/F;AAED;AACF,KAPD,EAOGC,KAPH,CAOS,YAAM;AACbpB,MAAAA,OAAO,CAACqB,KAAR,CAAc,yBAAd;AACD,KATD;AAUD,GAXU,EAWR,IAXQ,CAAX;AAaD,CA9BD,EA8BGD,KA9BH,CA8BS,YAAM;AACbpB,EAAAA,OAAO,CAACqB,KAAR,CAAc,sBAAd;AACD,CAhCD","sourcesContent":["import Vue from 'vue'\nimport App from './App.vue'\nimport vuetify from './plugins/vuetify'\nimport VueRouter from 'vue-router';\nimport {routes} from \"./routes\";\nimport Keycloak from \"keycloak-js\";\nimport VueJwtDecode from \"vue-jwt-decode\";\n\n\nconst router = new VueRouter({\n  routes: routes\n})\n\nVue.config.productionTip = false\nVue.use(VueRouter)\n\n\n//Keycloak Options\nlet initOptions = {\n  url: 'http://127.0.0.1:8080/auth',\n  realm: 'vue-keycloak',\n  clientId: 'app-vue',\n  onLoad: 'login-required'\n}\n\nlet keycloak = Keycloak(initOptions);\n\nkeycloak.init({ onLoad: initOptions.onLoad }).then((auth) => {\n  if (!auth) {\n    window.location.reload();\n  } else {\n    console.log(\"Authenticated\");\n\n    new Vue({\n      vuetify, router,\n      render: h => h(App, { props: { keycloak: keycloak } })\n    }).$mount('#app')\n  }\n\n  console.log(keycloak.token);\n  const decoded_token = VueJwtDecode.decode(keycloak.token);\n  console.log(decoded_token);\n\n//Token Refresh\n  setInterval(() => {\n    keycloak.updateToken(70).then((refreshed) => {\n      if (refreshed) {\n        console.log('Token refreshed' + refreshed);\n      } else {\n        console.warn('Token not refreshed, valid for '\n            + Math.round(keycloak.tokenParsed.exp + keycloak.timeSkew - new Date().getTime() / 1000) + ' seconds');\n      }\n    }).catch(() => {\n      console.error('Failed to refresh token');\n    });\n  }, 6000)\n\n}).catch(() => {\n  console.error(\"Authenticated Failed\");\n});"]}]}